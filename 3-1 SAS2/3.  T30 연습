1. 2010-2015년도에 생성된 명세서의 연도별 입원료(02) 총합과 검사료(09) 총합

-내거 
option validvarname=any;
data t30;
set Tmp1.nsc2_m30;
run;

data pr1;
set t30;
year=substr(MDCARE_STRT_DT,1,4);
if "2010"<=year<="2015";
if CLA_CD="02" then 비용청구="02";
else if CLA_CD="09" then 비용청구="09";
else delete;
run;

proc sql;
create table pr1_sql as
select year, 비용청구 ,sum(AMT) as total
from pr1
group by year, 비용청구;
quit;

proc sort data=pr1_sql out=ex1 nodupkey;
by year 비용청구;
run;

proc transpose data=ex1 out=ex1_re;
by year;
id 비용청구;
var total;
run;

/*
바로 해도 값이 나옴.
proc sql;
create table pr1_sql as
select year, 비용청구 ,sum(AMT) as total
from pr1
group by year, 비용청구;
quit;

proc transpose data=pr1_sql out=ex_sql;
by year;
id 비용청구;
var total;
run;
*/

-다른 조거


-교수님거




2. 위암(주상병만 고려) 명세서의 연도별(2010-2015) 입원료 총합
/*
오답
내가 하던거

data pr2;
set pr2_t30_20;
year=substr(MDCARE_STRT_DT,1,4);
if "2010"<=year<="2015" CLA_CD="09";
run;

proc sql;
create table pr2_t30_20 as
select a.*, b.SICK_SYM1 from t30 as a
left join Tmp1.nsc2_m20 as b on
a.RN_key=b.RN_key;
quit;
*/

/*상황에 따라 join, left join*/



-우리조거
/*c16을 구분하는게 없어서 안나옴*/

-교수님거
